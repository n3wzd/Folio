# NETS App

---

2021-09 ~ 2022-05 (5인)

## 배경
사회적으로 요양 서비스에 대한 수요가 증가하면서 병원 동행 서비스가 새롭게 떠오르고 있습니다. 만약 병원 동행과 모빌리티가 결합되면 편리함, 접근성이 높아질 것입니다. 이 프로젝트는 웹으로 제공되고 있는 병원 동행 서비스인 고위드유에 모빌리티 서비스가 추가된 네츠 모빌리티 앱을 개발하는 것이 목표입니다.

5인 프로젝트로 진행되었으며, 제가 담당한 부분은 DB 및 백엔드 서버 개발입니다.

## 기능
### 고객용 APP
고객이 이용하는 앱으로, 모바일을 통해 간편하게 병원 동행 서비스 예약 및 이용 방법 확인이 가능합니다.

- 로그인 / 회원가입
- 휴대폰 인증
- 서비스 예약
- 서비스 예약
- 결제
- 서비스 내역 조회
- 알림, 마이페이지
- 공지사항

### 매니저용 APP
고객과 함께 병원 동행을 하는 동행 매니저가 사용하는 앱입니다. 매니저가 직접 진행하는 서비스를 앱으로 관리하여 편리함이 향상됩니다.

- 로그인
- 휴대폰 인증
- 알림
- 서비스 내역
- 마이 페이지
- 공지사항

### 관리자용 APP
관리자가 이용하는 웹 UI로, 동행 서비스에 대한 전반적인 데이터를 관리할 수 있습니다.

- 고객 / 매니저 정보 조회
- 예약 / 서비스 내역 조회
- 세부사항 조정
- 공지사항 등록
- 통계 확인

## 스택
- HTML, CSS, Javascript: 개발 주 언어
- React, React Native: 프론트엔드 프레임워크
- Node.js: 백엔드 런타임 환경
- Express.js: 백엔드 프레임워크
- MySQL: 데이터베이스

## 문제 및 해결
### JWT 토큰 로그아웃
클라이언트 측에서 JWT 토큰을 사용하여 인증을 처리하지만, 로그아웃 시 서버에서 이미 발행된 토큰을 직접 수정하거나 무효화할 수는 없습니다. 이로 인해 로그아웃 처리에 어려움이 발생합니다.

클라이언트 측에서 토큰을 사용하지 않도록 설정하는 방법이 있습니다. 추가로 서버 측에서 로그아웃된 토큰을 식별하고 이를 무효화하거나 별도의 처리 로직을 구현하는 방식으로 문제를 해결할 수 있습니다.

클라이언트와 서버 모두에서 로그아웃된 사용자의 토큰이 더 이상 사용되지 않도록 처리함으로써 보안성을 유지할 수 있습니다.

### React 파일 업로드 및 Express 연동
React에서 파일을 업로드하고 Express 서버로 전송할 때, Multer 라이브러리를 사용하여 파일을 처리합니다. 이 과정에서 input 태그의 `name` 속성, FormData의 키 값, 그리고 Multer에서 지정하는 파일 이름이 일치하지 않으면 파일 업로드가 실패할 수 있습니다.

정상적인 파일 업로드를 위해서는 input 태그의 `name` 속성, FormData에서 파일을 append할 때 사용하는 키 값, 그리고 Multer에서 파일을 처리할 때 지정하는 인자 이름이 모두 동일해야 합니다. 예를 들어, `<input name="file">`로 설정했다면, FormData에서도 `formData.append('file', file)`로 동일한 키를 사용해야 하며, 서버에서는 `multer().single('file')`로 동일한 이름을 지정해야 합니다.

이 설정을 적용하면 파일이 누락되거나 `req.file`이 undefined가 되는 문제를 방지할 수 있으며, 파일 업로드가 안정적으로 처리됩니다.

### 표준시 +0900 설정
시간 데이터를 처리할 때 시간 문자열에 타임존 정보를 포함하지 않으면 올바른 시간이 표시되지 않거나, 해외 서버를 사용할 때 혼란이 발생할 수 있습니다.

시간 문자열에 타임존 정보인 "+0900"을 포함시켜 한국 시간(GMT+9)을 명시해줍니다. 또한, `toISOString` 메서드를 사용하여 UTC 시간을 반환하고, 필요한 경우 로컬 타임존으로 변환합니다.

이 방법을 적용하면 정확한 시간 데이터를 유지할 수 있으며, 특히 해외 서버와의 연동에서도 시간 오류를 방지할 수 있습니다.
